{% extends "ggchat/base.html" %}

{% block main %}
    {% if name == None %}
        <p>Пользователь не найден =(</p>
    {% else %}
        {# row 1 #}
        <div class="row">
            <div class="col-sm-8">
                <h4>Последние сообщения</h4>
                <div class="table-responsive">
                    <table class="table table-bordered table-hover table-striped">
                        <thead>
                        <tr><th>Дата</th><th>Канал</th><th>Сообщение</th></tr>
                        </thead>
                        <tbody>
                        {% for message in messages %}
                            <tr>
                            <td>{{ message.timestamp }}</td>
                                <td><a href="/channel/{{ message.channel_id }}">{{ message.channel.streamer.username }}</a></td>
                            <td>{{ message.text }}</td>
                            </tr>
                        {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>
            <div class="col-sm-4">
                <h4>Активные премиумы</h4>
                <div class="table-responsive">
                    <table class="table table-bordered table-hover table-striped">
                        <thead>
                        <tr><th>Дата</th><th>Канал</th><th>Стрик ресабов</th></tr>
                        </thead>
                        <tbody>
                        {% for premium in active_premiums %}
                            <tr>
                            <td>{{ premium.started }}</td>
                            <td>{% if premium.channel.streamer.username %}
                                    <a href="/channel/{{ premium.channel_id }}">{{ premium.channel.streamer.username }}</a>
                                {% elif premium.channel_id == "0" %}
                                    Общий премиум
                                {% else %}
                                    <a href="/channel/{{ premium.channel_id }}">{{ premium.channel_id }}</a>
                                {% endif %}
                            </td>
                            <td>{{ premium.resubs }}</td>
                            </tr>
                        {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        {# row 2 #}
        <div class="row">
            <div class="col-sm-8">
                <h4>Последние донаты</h4>
                <div class="table-responsive">
                    <table class="table table-bordered table-hover table-striped">
                        <thead>
                        <tr><th>Дата</th><th>Канал</th><th>Сумма</th><th>Сообщение</th></tr>
                        </thead>
                        <tbody>
                        {% for donation in donations %}
                            <tr>
                            <td>{{ donation.timestamp }}</td>
                            <td>
                                {% if donation.channel.streamer.username %}
                                    <a href="/channel/{{ donation.channel_id }}">{{ donation.channel.streamer.username }}</a>
                                {% elif donation.link %}
                                    <a href="{{ donation.link }}">{{ donation.link }}</a>
                                {% else %}
                                    <a href="/channel/{{ donation.channel_id }}">{{ donation.channel_id }}</a>
                                {% endif %}
                            </td>
                            <td>{{ donation.amount }}</td>
                            <td>{{ donation.text }}</td>
                            </tr>
                        {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>
            <div class="col-sm-4">
                <h4>Последние активированные премиумы</h4>
                <div class="table-responsive">
                    <table class="table table-bordered table-hover table-striped">
                        <thead>
                        <tr><th>Дата</th><th>Канал</th><th>Стрик ресабов</th></tr>
                        </thead>
                        <tbody>
                        {% for premium in premiums %}
                            <tr>
                            <td>{{ premium.timestamp }}</td>
                            <td><a href="/channel/{{ premium.channel_id }}">{{ premium.channel.streamer.username }}</a></td>
                            <td>{{ premium.resubs }}</td>
                            </tr>
                        {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        {# row 3 #}
        <div class="row">
            <div class="col-sm-8">
                <h4>Последние подписки на каналы</h4>
                <div class="table-responsive">
                    <table class="table table-bordered table-hover table-striped">
                        <thead>
                        <tr><th>Дата</th><th>Канал</th></tr>
                        </thead>
                        <tbody>
                        {% for follow in follows %}
                            <tr>
                            <td>{{ follow.timestamp }}</td>
                                <td><a href="/channel/{{ follow.channel_id }}">{{ follow.channel.streamer.username }}</a></td>
                            </tr>
                        {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>
            <div class="col-sm-4">

            </div>
        </div>

    {% endif %}
{% endblock %}
